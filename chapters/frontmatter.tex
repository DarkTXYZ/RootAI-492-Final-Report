\maketitle
\makesignature

\ifproject
\begin{abstractTH}
เกมกระดาน ``รูท'' เป็นเกมแนวอสมมาตรที่สังเกตได้บางส่วน โดยผู้เล่นแต่เผ่าจะมีวิธีการเล่นเกมและเป้าหมายที่แตกต่างกัน รูทประกอบไปด้วยหลายเผ่าที่ผู้เล่นสามารถเล่นได้ แต่ละเผ่าจะมีวิธีการบรรลุเงื่อนไขการชนะของเกม ซึ่งก็คือการเก็บวิคทอรีพอยท์ (วีพี) ให้ได้ 30 หน่วย

รูทเวอร์ชันวิดีโอเกมได้ถูกวางหน่ายในปี ค.ศ. 2020 แต่ผลตอบรับจากผู้เล่นและชุมชนออนไลน์ออกมาว่า ปัญญาประดิษฐ์ในวิดีโอเกมรูทนั้นไม่เก่งพอ ด้วยเหตุนี้ระบบปัญญาประดิษฐ์ที่สามารถเล่นเกมรูทได้ จึงได้ถูกสร้างขึ้นมาในโครงการนี้ ในแต่ละเฟสของเกม ปัญญาประดิษฐ์ของเราจะรับสถานะปัจจุบันของเกมแล้วเลือกแอคชันที่ควรทำอย่างชาญฉลาด ในโครงการนี้ปัญญาประดิษฐ์สำหรับ 2 เผ่าหลักของเกม ได้แก่ ``มาร์กีส์'' เดอ แคท และ ``อีรีย์'' ไดนาสตี ปัญญาประดิษฐ์ 1 ตัวต่อ 1 เผ่า ได้ถูกสร้างขึ้น 

อัลกอริธึมหลักที่จะในการสร้างปัญญาประดิษฐ์คือ ค้นหาต้นไม้มอนติคาร์โล อัลกอริทึมค้นหาต้นไม้มอนติคาร์โลจะเพิ่มความน่าจะเป็นที่จะชนะให้มากที่สุด โดยการจำลองการเล่นหลายๆ ครั้ง และตัดสินใจเลือกวิธีเล่นที่ดีที่สุด อัลกอริทึมค้นหาต้นไม้มอนติคาร์โลของโครงการนี้มีพารามิเตอร์ทั้งหมด 6 ตัว ได้แก่ \texttt{reward-function}, \texttt{expand-count}, \texttt{rollout-no}, \texttt{time-limit}, \texttt{action-count-limit}, และ \texttt{best-action-policy} อัลกอริทึมค้นหาต้นไม้มอนติคาร์โล 108 รูปแบบได้ถูกสร้างขึ้นสำหรับแต่ละเผ่าโดยการเปลี่ยนค่าพารามิเตอร์เหล่านี้ อัลกอริทึมค้นหาต้นไม้มอนติคาร์โลทั้ง 108 รูปแบบถูกนำไปต่อสู้กับเผ่าคู่ต่อสู้ ซึ่งจะใช้อัลกอริทึมค้นหาต้นไม้มอนติคาร์โลรูปแบบพื้นฐาน รูปแบบที่มีอัตราการชนะสูงที่สุด 5 รูปแบบของแต่ละเผ่า จะถูกเลือกเพื่อนำไปต่อสู้กันเองต่อ ท้ายที่สุด จะได้รูปแบบอัลกอริทึมค้นหาต้นไม้มอนติคาร์โลที่ดีที่สุดของแต่ละเผ่า

รูปแบบอัลกอริทึมค้นหาต้นไม้มอนติคาร์โลที่ดีที่สุดของเผ่ามาร์กีส์ เดอ แคท มีค่าพารามิเตอร์ตามลำดับที่กล่าวด้านบนดังนี้: \texttt{vp-difference-relu}, \texttt{200}, \texttt{1}, \texttt{-1 (ไม่มีลิมิต)}, \texttt{-1 (ไม่มีลิมิต)}, และ \texttt{secure} โดยมีอัตราการชนะเฉลี่ยเมื่อสู้กับเผ่าอีรีย์ ไดนาสตี อยู่ที่ 56.0\% รูปแบบอัลกอริทึมค้นหาต้นไม้มอนติคาร์โลที่ดีที่สุดของเผ่าอีรีย์ ไดนาสตี มีค่าพารามิเตอร์ตามลำดับที่กล่าวด้านบนดังนี้: \texttt{vp-difference-relu}, \texttt{200}, \texttt{1}, \texttt{-1 (ไม่มีลิมิต)}, \texttt{-1 (ไม่มีลิมิต)}, และ \texttt{secure} โดยมีอัตราการชนะเฉลี่ยเมื่อสู้กับเผ่ามาร์กีส์ เดอ แคท อยู่ที่ 63.4\%

% เป้าหมายของโครงการนี้คือ การพัฒนาระบบปัญญาประดิษฐ์ที่สามารถเล่นเกมกระดาน ``Root'' ได้อย่างชาญฉลาดและมีประสิทธิภาพ โดยระบบจะรับ state ปัจจุบันของเกม และทำการตัดสินใจเลือกทำ action ต่างๆในระหว่างการเล่น

% Root เป็นเกมแนวอสมมาตร (asymmetric) และ  ที่สามารถสังเกตได้บางส่วน (partially observable) โดยผู้เล่นแต่ละคนมีวิธีการเล่นเกมและเป้าหมายที่แตกต่างกัน ตามเผ่า (faction) ที่ตนเองได้เล่น ซึ่งในเกมกระดาน Root ประกอบไปด้วยหลายเผ่ามากมาย แต่ในโครงการนี้เราจะสนใจที่ 2 เผ่าหลัก ได้แก่เผ่า ``Marquise'' de Cat และเผ่า the ``Eyrie'' Dynasties

% อัลกอริทึมหลักที่เราจะใช้ในการสร้างปัญญาประดิษฐ์คือ Monte Carlo Tree Search (MCTS) ซึ่งเป็นการหาความน่าจะเป็นในการชนะของแต่ละ action ที่ทำได้โดยการจำลองการเล่นด้วย action นั้นซ้ำหลายๆรอบ จากนั้นเลือก action ที่ทำให้ความน่าจะเป็นในการชนะสูงที่สุด

% อัลกอริทึม MCTS มี parameters หลายตัว นั่นทำให้มี variant ของ MCTS อยู่หลาย variant เราจะนำ MCTS แต่ละ variant มาแข่งเพื่อหา variant ของ MCTS ที่ดีที่สุดสำหรับแต่ละเผ่า

%%%%%%

% เขียนบทคัดย่อของโครงงานที่นี่

% การเขียนรายงานเป็นส่วนหนึ่งของการทำโครงงานวิศวกรรมคอมพิวเตอร์
% เพื่อทบทวนทฤษฎีที่เกี่ยวข้อง อธิบายขั้นตอนวิธีแก้ปัญหาเชิงวิศวกรรม และวิเคราะห์และสรุปผลการทดลองอุปกรณ์และระบบต่างๆ
% \enskip อย่างไรก็ดี การสร้างรูปเล่มรายงานให้ถูกรูปแบบนั้นเป็นขั้นตอนที่ยุ่งยาก
% แม้ว่าจะมีต้นแบบสำหรับใช้ในโปรแกรม Microsoft Word แล้วก็ตาม
% แต่นักศึกษาส่วนใหญ่ยังคงค้นพบว่าการใช้งานมีความซับซ้อน และเกิดความผิดพลาดในการจัดรูปแบบ กำหนดเลขหัวข้อ และสร้างสารบัญอยู่
% \enskip ภาควิชาวิศวกรรมคอมพิวเตอร์จึงได้จัดทำต้นแบบรูปเล่มรายงานโดยใช้ระบบจัดเตรียมเอกสาร
% \LaTeX{} เพื่อช่วยให้นักศึกษาเขียนรายงานได้อย่างสะดวกและรวดเร็วมากยิ่งขึ้น
\end{abstractTH}

\begin{abstract}
The board game called ``Root'' is a partially observable asymmetric game where each player has different game mechanics and goals. There are many factions within Root, each having its own way to achieve the victory condition of accumulating 30 victory points (VP). 

A video game version of Root was released in 2020, but the feedback from the online community stated that the artificial intelligence (AI) in the \RootV{} is lacking and incompetent. An AI system capable of playing Root was developed in this project due to that reason. The AI agents can take game state as input and make intelligent decisions in each phase. An AI agent for each of the 2 base factions: ``Marquise'' de Cat and the ``Eyrie'' Dynasties was made in this project.

The main algorithm for implementing the AI is Monte Carlo Tree Search (MCTS). MCTS algorithm maximizes the probability of winning by simulating many rollouts and choosing the best decision.This project's MCTS algorithm has 6 parameters: \texttt{reward-function}, \texttt{expand-count}, \texttt{rollout-no}, \texttt{time-limit}, \texttt{action-count-limit}, and \texttt{best-action-policy}. We created 108 MCTS agent variants for each faction by altering these parameters. The 108 variants are pitched against the other faction with the base variant. The top 5 variants with the highest win rate for each faction are selected. The top 5 variants from each faction all play against each of the other faction's. The best variant for each faction is then selected.

The best MCTS variant for \Marquise{} has the following parameters respective to the above parameter list: \texttt{vp-difference}, \texttt{200}, \texttt{1}, \texttt{-1 (no limit)}, \texttt{100}, and \texttt{max}. It an achieved average win rate against top 5 \Eyrie{} agents of 56.0\%. The best MCTS variant for \Eyrie{} have the following parameters respective to the above parameter list: \texttt{vp-difference}, \texttt{200}, \texttt{1}, \texttt{-1 (no limit)}, \texttt{30}, and \texttt{robust}. It achieved an average win rate against top 5 \Marquise{} agents of 63.4\%.



% To build the AI, we will construct multiple AI agents and have them play against one another so they can both improve themselves. Each agent will have different versions built from different algorithms, including Monte Carlo Tree Search, Neural Network Reinforcement Learning, random, weighted-random, hard-coded, human player, etc.

% We aim to develop an artificial intelligence (AI) system capable of playing the board game "Root." Our objective is to create an intelligent agent that can take game state as input, make decisions in each phase, and compete against the AI in the digital adaptation video game of the board game Root.

% Root is a partially observable asymmetric game where each player has different game mechanics and goals. This can be applied to real-world problems where different parties have different goals but are in the same area, so they have to compete to take hold of the limited resources needed to complete their goals.

% To build the AI, we will have an agent play against another agent so they can both learn. Each agent will have different versions built from different algorithms, including Monte Carlo Tree Search, Neural Network Reinforcement Learning, random, weighted-random, hard-coded, human player, etc.
% ------
% The abstract would be placed here. It usually does not exceed 350 words
% long (not counting the heading), and must not take up more than one (1) page
% (even if fewer than 350 words long).

% Make sure your abstract sits inside the \texttt{abstract} environment.
\end{abstract}

\iffalse
\begin{dedication}
This document is dedicated to all Chiang Mai University students.

Dedication page is optional.
\end{dedication}
\fi % \iffalse

\begin{acknowledgments}
We would like to express our deep appreciation for Asst. Prof. Kasemsit Teeyapan, Ph.D. for his exceptional dedication, expertise, and detailed guidance throughout the project, which served as a constant source of inspiration and helped ensure its successful completion.
% Your acknowledgments go here. Make sure it sits inside the
% \texttt{acknowledgment} environment.

\acksign{2024}{02}{18}
\end{acknowledgments}%
\fi % \ifproject

\contentspage

\ifproject
\figurelistpage

\tablelistpage
\fi % \ifproject

% \abbrlist % this page is optional

% \symlist % this page is optional

% \preface % this section is optional
